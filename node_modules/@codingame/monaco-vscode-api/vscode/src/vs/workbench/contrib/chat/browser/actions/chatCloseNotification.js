
import { timeout } from '../../../../../base/common/async.js';
import { localize } from '../../../../../nls.js';
import { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';
import { NeverShowAgainScope } from '../../../../../platform/notification/common/notification.js';
import { INotificationService } from '../../../../../platform/notification/common/notification.service.js';
import { openAgentSessionsView } from '../agentSessions/agentSessions.js';
import { IChatWidgetService } from '../chat.service.js';
import Severity$1 from '../../../../../base/common/severity.js';

function showCloseActiveChatNotification(accessor, sessionResource) {
    const notificationService = accessor.get(INotificationService);
    const chatWidgetService = accessor.get(IChatWidgetService);
    const instantiationService = accessor.get(IInstantiationService);
    const waitAndShowIfNeeded = async () => {
        await timeout(100);
        if (sessionResource && chatWidgetService.getWidgetBySessionResource(sessionResource)) {
            return;
        }
        notificationService.prompt(Severity$1.Info, ( localize(
            4669,
            "A chat session is in progress. It will continue running in the background."
        )), [
            {
                label: ( localize(4670, "Open Agent Sessions")),
                run: async () => instantiationService.invokeFunction(openAgentSessionsView)
            }
        ], {
            neverShowAgain: {
                id: 'chat.closeWithActiveResponse.doNotShowAgain2',
                scope: NeverShowAgainScope.APPLICATION
            }
        });
    };
    void waitAndShowIfNeeded();
}

export { showCloseActiveChatNotification };
